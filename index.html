<!DOCTYPE html>
<html lang="en" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Selector</title>
    <style>
        .input-group {
            margin-bottom: 1rem;
        }
        .input-group label {
            font-weight: bold;
        }
        .input-group input {
            width: 150px;
            margin-left: 1rem;
        }
        .button-container {
            margin-top: 2rem;
        }
        .red{
            background-color: rgb(125, 134, 254);
            min-height: .5rem;
            margin: 0.75;
        }
        h1,h2{
            color:rgb(7, 135, 190);
            margin: 0;
            padding: 0;
        }
        h2{
            margin-bottom: 1rem;
            border-bottom: 6px solid rgb(246, 178, 59);
        }
    </style>
</head>
<body>
    <h1>مُولِّد اختبار تجريبي عشوائي</h1>

    <div class="input-group">
        <label for="groupSizes">حجم كل مجموعة (بالأعداد):</label>
        <input type="text" id="groupSizes" value="92,200,100">
    </div>

    <div class="input-group">
        <label for="imagesToSelect">عدد الصور للاختيار:</label>
        <input type="number" id="imagesToSelect" value="30">
    </div>

    <div class="input-group">
        <label for="groupRange">نطاق الوحدات (مثال: 1-4 أو 1,2,3):</label>
        <input type="text" id="groupRange" value="1-4">
    </div>

    <div class="button-container">
        <button onclick="displayImages()">إنشاء الاختبار</button>
    </div>

    <script>
        function selectRandomImages(group, imagesToSelect, imagesPerGroup) {
            const selectedImagesForGroup = [];

            for (let i = 0; i < imagesToSelect; i++) {
                let randomIndex;
                let randomImage;
                do {
                    randomIndex = Math.floor(Math.random() * imagesPerGroup) + 1;
                    randomImage = `g${group}/math_0${group}_${randomIndex}.jpg`;
                } while (selectedImagesForGroup.includes(randomImage));

                let img = new Image();

                img.onerror = function() {
                    // If an error occurs (image doesn't exist), try again with a different index
                    selectRandomImages(group, imagesToSelect, imagesPerGroup);
                };

                img.src = randomImage;
                selectedImagesForGroup.push(randomImage);
            }

            return selectedImagesForGroup;
        }

        function displayImages() {
            // Retrieve values from input fields
            const groupSizes = document.getElementById('groupSizes').value.split(',').map(Number);
            const imagesToSelect = parseInt(document.getElementById('imagesToSelect').value);
            const groupRange = document.getElementById('groupRange').value;

            let selectedGroups = [];
            if (groupRange.includes('-')) {
                const [start, end] = groupRange.split('-').map(Number);
                selectedGroups = Array.from({ length: end - start + 1 }, (_, i) => i + start);
            } else {
                selectedGroups = groupRange.split(',').map(Number);
            }

            const selectedImages = [];

            for (let i of selectedGroups) {
                const imagesPerGroup = groupSizes[i - 1]; // Adjust index
                const availableImages = Array.from({ length: imagesPerGroup }, (_, j) => j + 1);
                const selectedImagesForGroup = selectRandomImages(i, imagesToSelect, imagesPerGroup);
                selectedImages.push(...selectedImagesForGroup);
            }

            const outputDiv = document.createElement('div');
            outputDiv.innerHTML = `<h2>الوحدات المحددة</h2>`;

            for (const image of selectedImages) {
                const imgElement = document.createElement('img');
                imgElement.src = image;

                outputDiv.appendChild(imgElement);
                const imgLine = document.createElement('div');
                imgLine.classList= 'red';
                outputDiv.appendChild(imgLine);
            }

            document.body.appendChild(outputDiv);
        }
    </script>
</body>
</html>
